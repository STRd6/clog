// Generated by CoffeeScript 1.6.2
(function() {
  var churn, countNodes, exec, fs, getNode, glob, nodes, spawn, _ref;

  _ref = require('child_process'), spawn = _ref.spawn, exec = _ref.exec;

  nodes = require('coffee-script').nodes;

  fs = require('fs');

  glob = require('glob');

  getNode = function(node, totalNodes) {
    if (totalNodes == null) {
      totalNodes = 0;
    }
    node.expressions.forEach(function(n) {
      var body, _ref1;

      if ((body = (_ref1 = n.value) != null ? _ref1.body : void 0) != null) {
        getNode(body, totalNodes);
      }
      return totalNodes += 1;
    });
    return totalNodes;
  };

  churn = function(filePath, cb) {
    return exec("git whatchanged " + filePath + " | grep 'commit' | wc -l", cb);
  };

  countNodes = function(filePath) {
    var tree;

    tree = nodes(fs.readFileSync(filePath, 'utf8'));
    return getNode(tree);
  };

  exports.clog = {
    churn: churn,
    countNodes: countNodes,
    run: function() {
      return glob('**/*.coffee', function(err, files) {
        return files.forEach(function(file) {
          return churn(file, function(err, output) {
            return console.log(output);
          });
        });
      });
    }
  };

}).call(this);
